<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <link rel="icon" href="/logo-assets/touch/homescreen192.png"><meta name="theme-color" content="#49BF7C"><link rel="manifest" href="/manifest.json"><meta prefix="og: http://ogp.me/ns#" property="og:type" content="article"><meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://cdn.jsdelivr.net/gh/sustech-cra/sustech-online-ng@master/docs/assets/og-image.png"><meta prefix="og: http://ogp.me/ns#" property="og:article:author" content="sustech.online"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="apple-touch-icon" href="/logo-assets/touch/homescreen168.png"><meta name="msapplication-TileImage" content="/logo-assets/touch/homescreen144.png"><meta name="msapplication-TileColor" content="#49BF7C"><meta name="google-site-verification" content="Av-srANCmFA_yZ8Iasa1yQsIPJCF_zlP5AoD35m6_Ww"><script async src="https://www.googletagmanager.com/gtag/js?id=G-1BQBXDGY3R"></script><script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-1BQBXDGY3R');
    </script><script src="/wx_helper.js"></script><script src="https://res.wx.qq.com/open/js/jweixin-1.6.0.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.1/dist/jquery.fancybox.min.css"><script src="https://cdn.jsdelivr.net/npm/datatables.net@1.10.21/js/jquery.dataTables.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/datatables@1.10.18/media/css/jquery.dataTables.min.css"><title>校内 IPv6 设置教程 | 南科手册</title><meta name="description" content="Online manual for sustecher">
    <link rel="preload" href="/assets/js/runtime~app.5ff38486.js" as="script"><link rel="preload" href="/assets/css/styles.66d274d8.css" as="style"><link rel="preload" href="/assets/js/4011.f9658fd6.js" as="script"><link rel="preload" href="/assets/js/app.8ab16e06.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.66d274d8.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">南科手册</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/miniapp/" class="nav-link" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/about/" class="nav-link" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/site-help/" class="nav-link" aria-label="站点帮助"><!--[--><!--]--> 站点帮助 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/news/" class="nav-link" aria-label="更新日志"><!--[--><!--]--> 更新日志 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/sustech-cra/sustech-online-ng" rel="noopener noreferrer" target="_blank" aria-label="在Github上查看"><!--[--><!--]--> 在Github上查看 <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="主页"><!--[--><!--]--> 主页 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/miniapp/" class="nav-link" aria-label="小程序"><!--[--><!--]--> 小程序 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/about/" class="nav-link" aria-label="关于"><!--[--><!--]--> 关于 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/site-help/" class="nav-link" aria-label="站点帮助"><!--[--><!--]--> 站点帮助 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/news/" class="nav-link" aria-label="更新日志"><!--[--><!--]--> 更新日志 <!--[--><!--]--></a></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/sustech-cra/sustech-online-ng" rel="noopener noreferrer" target="_blank" aria-label="在Github上查看"><!--[--><!--]--> 在Github上查看 <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><a href="/" class="nav-link sidebar-heading sidebar-item" aria-label="📚南科手册"><!--[--><!--]--> 📚南科手册 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/facility/" class="nav-link sidebar-heading sidebar-item" aria-label="🏫建筑与设施"><!--[--><!--]--> 🏫建筑与设施 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/contact/" class="nav-link sidebar-heading sidebar-item" aria-label="📇黄页"><!--[--><!--]--> 📇黄页 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/calendar/" class="nav-link sidebar-heading sidebar-item" aria-label="📅校历"><!--[--><!--]--> 📅校历 <!--[--><!--]--></a><ul class=""><li><!--[--><p class="sidebar-item">历史校历（存档）</p><ul class="sidebar-sub-items"><li><!--[--><a href="/calendar/2021-2022.md" class="nav-link sidebar-item" aria-label="2021-2022 学年"><!--[--><!--]--> 2021-2022 学年 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/calendar/2020-2021.md" class="nav-link sidebar-item" aria-label="2020-2021 学年"><!--[--><!--]--> 2020-2021 学年 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li></ul><!--]--><!--[--><a href="/service/" class="nav-link router-link-active sidebar-heading sidebar-item" aria-label="🖥服务与技巧"><!--[--><!--]--> 🖥服务与技巧 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/life/" class="nav-link sidebar-heading sidebar-item" aria-label="👨‍🎓生活在南科"><!--[--><!--]--> 👨‍🎓生活在南科 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/study/" class="nav-link sidebar-heading sidebar-item" aria-label="🎓学在南科"><!--[--><!--]--> 🎓学在南科 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/organizations/" class="nav-link sidebar-heading sidebar-item" aria-label="🎡社团活动"><!--[--><!--]--> 🎡社团活动 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/media/" class="nav-link sidebar-heading sidebar-item" aria-label="📺媒体与网站"><!--[--><!--]--> 📺媒体与网站 <!--[--><!--]--></a><!----><!--]--><!--[--><a href="/transport/" class="nav-link sidebar-heading sidebar-item" aria-label="🚄交通"><!--[--><!--]--> 🚄交通 <!--[--><!--]--></a><ul class=""><li><!--[--><a href="/transport/bustimer.md" class="nav-link sidebar-item" aria-label="🚌新版巴士时刻表"><!--[--><!--]--> 🚌新版巴士时刻表 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/transport/workday.md" class="nav-link sidebar-item" aria-label="🚌校园巴士-工作日"><!--[--><!--]--> 🚌校园巴士-工作日 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/transport/holiday.md" class="nav-link sidebar-item" aria-label="🚌校园巴士-节假日"><!--[--><!--]--> 🚌校园巴士-节假日 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/transport/" class="nav-link sidebar-item" aria-label="周围交通"><!--[--><!--]--> 周围交通 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--[--><a href="/surroundings/" class="nav-link sidebar-heading sidebar-item" aria-label="🛍周边"><!--[--><!--]--> 🛍周边 <!--[--><!--]--></a><!----><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="校内-ipv6-设置教程" tabindex="-1"><a class="header-anchor" href="#校内-ipv6-设置教程" aria-hidden="true">#</a> 校内 IPv6 设置教程</h1><p>本篇教程是在南方科技大学的网络环境下写成。据我所知，下发128位前缀 IPv6 地址的学校不止南科大一所，本篇教程事实上具有普适性，其他大学的同学也可以进行参考。</p><p>事实上，在中国电信的家宽一般下发56位前缀的地址，也可使用本方法，但并无必要，可直接由路由分配地址无需 NAT。</p><p>南科大的 IPv6 下发的地址是 128位前缀，换言之，子网大小为 1，仅够一台设备使用。为了让一个物理网口下的多个设备共享网络，常见的解决方案是（1）交换机（2）路由器。两者的区别想必需要用到此教程的同学应该了解，这里仅介绍具体配置。</p><h2 id="ipv6-桥接" tabindex="-1"><a class="header-anchor" href="#ipv6-桥接" aria-hidden="true">#</a> IPv6 桥接</h2><p>根据工信部<a href="https://www.miit.gov.cn/jgsj/txs/wjfb/art/2020/art_ed97eb9802da4f168acb823227663f1b.html" target="_blank" rel="noopener noreferrer">《关于开展2019年IPv6网络就绪专项行动的通知》<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 的要求，“新部署的家庭网关设备应全部支持IPv6，并默认配置支持IPv4/IPv6双栈，能够为网关下挂设备分配 IPv6 地址”。同学们新购买的路由器应该都支持 IPv6。例如水星等，国产路由器一般会将 IPv6 与 IPv4的设置分开。</p><p>在南科大校园网下，在 IPv6 的设置中选择 “桥接模式” 或 ”中继模式“，下级设备应该能分配到 2001 开头的公网 IPv6 地址。</p><h2 id="ipv6-nat-©️-戴郭轶" tabindex="-1"><a class="header-anchor" href="#ipv6-nat-©️-戴郭轶" aria-hidden="true">#</a> IPv6 NAT ©️ 戴郭轶</h2><p>一些同学如果有特殊需求可能会使用 OpenWrt，里面有丰富的插件提供多样的服务。</p><p>这篇教程可以说是一篇咕咕咕了很久的教程，大概是在去年才开学的时候，当时公网限速在 700KB/s，所以就买了新路由3刷了 OpenWrt 进行多拨来解除限速，（现在解除了，最快能够跑到 90MB/s 左右，没有必要使用多拨来提升带宽）。不过当时也花了很久配置 IPv6 的经验，可能仍值得分享。</p><p>由于南科大的分配的128位前缀的地址，子网空间不足，需要使用本该被淘汰掉的 NAT 网络地址转换使得下级设备能够联网，正确配置后的效果如下：</p><p><img src="/assets/img/image.479a39f2.png" alt="img"></p><p>同时北洋园和蒲公英pt均能正常识别（需要在OpenWrt开启 UPnP ）：</p><p><img src="data:image/png;base64,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" alt="img"></p><p><img src="/assets/img/image-2.8696ce12.png" alt="img"></p><p><strong>（PS：不要学我IPv6不打码直接发，因为 v6 默认就是公网地址，我在发完教程后会使用新的地址）</strong></p><p>电脑能成功获取内网IPv6,同时手机也能获得64位的 v6 地址，正常访问 v6 网络：</p><p><img src="/assets/img/image-3.02e26d7e.png" alt="img"></p><p>相应的流程并不复杂，只需要一台刷入OpenWrt的路由器，一台电脑，WinSCP（可选），以及足够的耐心。</p><p>首先，我们需要登录进入路由器的后台管理页面,依次点击网络-接口：</p><p>将全局网络选项前缀进行修改，我个人使用的是 <code>fd34:fe56:7891:2f3a::/64</code>；可以按照自己喜好选择一个内网前缀。</p><p><img src="/assets/img/image-4-1024x143.2a090d7f.png" alt="img"></p><p>随后单击lan一栏的修改，我们需要修改一下内网的设置，滑到下方，点击高级设置，按照下图进行勾选：</p><p><img src="/assets/img/image-5-1024x257.64606c22.png" alt="img"></p><p>然后点击IPv6设置，路由器通告服务和DHCPv6服务修改为服务器模式，NDP代理设置为禁用，DHCPv6选择无状态的+有状态的，并勾选总是通告默认路由：</p><p><img src="/assets/img/image-6-1024x333.35fa27ad.png" alt="img"></p><p>完成后点击保存&amp;应用。</p><p>随后进入wan口的设置，勾选上使用内置的IPv6管理</p><p><img src="/assets/img/image-7.92fbc0c7.png" alt="img"></p><p>随后进入wan6口的设置，将协议修改为DHCPv6客户端，请求IPv6地址为force，请求指定长度的IPv6前缀为已禁用：</p><p><img src="/assets/img/image-8-1024x484.331032f7.png" alt="img"></p><p>进入高级设置，勾选上使用内置的IPv6管理，强制链路和使用默认网关：</p><p><img src="/assets/img/image-9-1024x435.08f5d1e0.png" alt="img"></p><p>之后选择网络-DHCP/DNS，进入高级设置，取消勾选禁止解析IPv6 DNS记录：</p><p><img src="/assets/img/image-10-1024x161.2a97dbab.png" alt="img"></p><p>进入网络-防火墙：</p><p>将转发改为接受，下面的区域也需要改：</p><p><img src="/assets/img/image-11-1024x983.924ed25d.png" alt="img"></p><p>进入自定义规则，粘贴如下内容：</p><p><img src="/assets/img/image-13-1024x530.58c81057.png" alt="img"></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>WAN6=eth0.2
LAN=br-lan
ip6tables -t nat -A POSTROUTING -o $WAN6 -j MASQUERADE
ip6tables -A FORWARD -m conntrack –ctstate RELATED,ESTABLISHED -j ACCEPT
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>其中 <code>eth0.2</code> 和 <code>br-lan</code> 需要修改为你网络-接口中显示的内容：</p><p><img src="/assets/img/image-12.9f5996ad.png" alt="img"></p><p>如果有多拨需求的，提醒一下需要在负载均衡中将 defalut-rule 的备用成员改成默认（使用主路由表），由于我重新刷机做的教程且现在没有多拨的必要，就不演示了，没有需求的可以略过这一点。</p><p>经过如上配置，重启路由器后，在网络，诊断中应该能够成功 ping 通 openwrt.org 的v6了，说明你的路由器已经成功接入 IPv6 网络了：</p><p><img src="/assets/img/image-14-1024x783.48b3c8ae.png" alt="img"></p><p>但是如果我们打开 <a href="https://www.test-IPv6.com/" target="_blank" rel="noopener noreferrer">https://www.test-IPv6.com/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> ，我们电脑还是没有连上v6的，这里就需要我们修改流量转发的路由表了，使用ssh工具连上路由器，没有的可以点击系统-TTYD终端：依次输入一下代码：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>route -A inet6 <span class="token function">add</span> default gw fe80::3e8c:93ff:fed0:83c2 dev eth0.2
/etc/init.d/firewall restart
/etc/init.d/network restart
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>其中，第一行的fe80开头的一串v6地址需要修改为本机的默认网关，可以在状态-概览下获得，如图：</p><p><img src="/assets/img/image-15-1024x173.35df410f.png" alt="img"></p><p>而后面的eth0.2就是你网口的编号了，和防火墙哪那里一样，这个时候我们再打开 <a href="https://www.test-IPv6.com/" target="_blank" rel="noopener noreferrer">https://www.test-IPv6.com/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> ，可以发现，我们电脑已经接入IPv6了：</p><p><img src="/assets/img/image-16-1024x538.314b13c1.png" alt="img"></p><p>但是，如果路由器关机重启后，我们刚才输入的三行代码会丢失，也就是会回到路由器有 IPv6 而电脑无法连接 IPv6 的状态，这个时候我们就需要编辑一个开机自启的脚本，让路由器再开机时自动添加：</p><p>具体操作为：使用 WinSCP 连接并登陆进入路由器，在 <code>/etc/hotplug.d/iface/</code> 目录下新建名为 <code>restart-IPv6</code> 的文件，修改内容为：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$ACTION</span>&quot;</span> <span class="token operator">=</span> <span class="token function">ifup</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token builtin class-name">exit</span> <span class="token number">0</span>
route -A inet6 <span class="token function">add</span> default gw fe80::3e8c:93ff:fed0:83c2 dev eth0.2
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>最后一行需要修改成和刚才一样的内容，然后给予可执行权限。</p><p>没有 WinSCP 的可以在终端内输入以下内容：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">vim</span> /etc/hotplug.d/iface/restart-IPv6
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>然后再文本框中输入上面的三行内容，按 Esc 后退出 insert 模式，输入 <code>:wq</code> 退出。</p><p>然后给予可执行权限：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">chmod</span> +x /etc/hotplug.d/iface/restart-IPv6
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p><img src="/assets/img/image-18.b4cdc8f8.png" alt="img"></p><p>这个时候，恭喜你，成功配置IPv6了哦~</p><p>对了，如果有挂pt需求的同学，别忘了在服务-UPnP中打开哦~</p><p>还存在一些应该是OpenWrt本身的问题，在使用IPv6的时候，无法手动配置端口转发，UPnP的端口转发是成功的，但是在防火墙下无法配置，使用 Socat 也没有成功。</p><p>感谢阅读！如果有什么问题或者建议，可以和我发邮件联系。</p><p>我的个人邮箱为：ntdgy2001@gmail.com / 12011211@mail.sustech.edu.cn</p><p>原文章地址（NAT 部分）©️ 戴郭轶：<a href="https://ntdgy.top/ntdgy/30/" target="_blank" rel="noopener noreferrer">https://ntdgy.top/ntdgy/30/<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/sustech-cra/sustech-online-ng/edit/master/docs/service/network/ipv6/README.md" rel="noopener noreferrer" target="_blank" aria-label="一起完善这本手册！"><!--[--><!--]--> 一起完善这本手册！ <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">2021/6/17 下午11:05:05</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: leezisy@gmail.com">liziwl</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script src="/assets/js/runtime~app.5ff38486.js" defer></script><script src="/assets/js/4011.f9658fd6.js" defer></script><script src="/assets/js/app.8ab16e06.js" defer></script>
  </body>
</html>
